<div *ngIf="!loading()" class="dashboard-wrapper">

  
  <div class="dashboard-header">
    <h2>Dashboard Overview</h2>
    <p>Your loan activity summary</p>
  </div>

 
  <div class="summary-grid">

   
    <mat-card class="summary-card">
    <div class="summary-icon-wrap">
      <mat-icon class="summary-icon">account_balance</mat-icon>
    </div>

      <div>
        <h3>Total Loans</h3>
        <p>{{ summary()?.totalLoans }}</p>
      </div>
    </mat-card>

    <mat-card class="summary-card">
      <div class="summary-icon-wrap">
  <mat-icon class="summary-icon">check_circle</mat-icon>
</div>

      <div>
        <h3>Active Loans</h3>
        <p>{{ summary()?.activeLoans }}</p>
      </div>
    </mat-card>


    <mat-card class="summary-card rejected">
    <div class="summary-icon-wrap">
      <mat-icon class="summary-icon">cancel</mat-icon>
    </div>
    <div>
      <h3>Rejected Loans</h3>
      <p>{{ rejectedLoans() }}</p>
    </div>
  </mat-card>


    <mat-card class="summary-card">
      <div class="summary-icon-wrap">
  <mat-icon class="summary-icon">lock</mat-icon>
</div>

      <div>
        <h3>Closed Loans</h3>
        <p>{{ summary()?.closedLoans }}</p>
      </div>
    </mat-card>

  </div>


  <mat-card class="chart-card">

  <h3 class="chart-title">Loan Repayment Progress</h3>

  <div class="chart-wrapper">
    <canvas
      baseChart
      [data]="chartData()"
      [type]="'bar'"
      [options]="chartOptions">
    </canvas>
  </div>

  <div class="chart-values">
    <div class="value paid">
      <span class="dot"></span>
      Paid Amount:
      <strong>₹ {{ paidAmount() | number:'1.0-0' }}</strong>
    </div>

    <div class="value outstanding">
      <span class="dot"></span>
      Outstanding:
      <strong>
        ₹ {{ summary()?.totalOutstandingAmount | number:'1.0-0' }}
      </strong>
    </div>
  </div>

</mat-card>

 
  <mat-card class="table-card">

    <div class="table-header">
      <h2>My Loans</h2>
    </div>

    <table mat-table [dataSource]="loans()" class="loan-table">

    
      <ng-container matColumnDef="loanId">
        <th mat-header-cell *matHeaderCellDef>Loan ID</th>
        <td mat-cell *matCellDef="let l">{{ l.loanId }}</td>
      </ng-container>

   
      <ng-container matColumnDef="loanType">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let l">{{ l.loanTypeName }}</td>
      </ng-container>

   
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef>Amount</th>
        <td mat-cell *matCellDef="let l">
          ₹ {{ l.amount | number:'1.0-0' }}
        </td>
      </ng-container>

    
      <ng-container matColumnDef="tenure">
        <th mat-header-cell *matHeaderCellDef>Tenure</th>
        <td mat-cell *matCellDef="let l">
          {{ l.tenure }} months
        </td>
      </ng-container>

     
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let l">
          <span class="status-chip" [ngClass]="l.status">
            {{ l.status }}
          </span>
        </td>
      </ng-container>

     
      <ng-container matColumnDef="appliedDate">
        <th mat-header-cell *matHeaderCellDef>Applied Date</th>
        <td mat-cell *matCellDef="let l">
          {{ l.appliedDate | date:'mediumDate' }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

    </table>

    
    <div class="empty-state" *ngIf="loans().length === 0">
      <mat-icon>info</mat-icon>
      <p>No loans found. Apply for a loan to get started.</p>
    </div>

  </mat-card>

</div>
